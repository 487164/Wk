<!--
title: Configuracion interfaz management
description: 
published: true
date: 2024-01-16T16:07:26.929Z
tags: linux, network, interface, mgmt
editor: ckeditor
dateCreated: 2024-01-16T11:03:56.302Z
-->

<h1 style="text-align:center;">Configuracion interfaz management</h1>
<p style="text-align:center;">&nbsp;</p>
<p>Dado los problemas de no poder conectar por la interfaz de management, se ha dado la siguiente solución que consiste en que si la conexión va por management, no salga por la interfaz de servicios ya que es la ruta de por defecto de la maquina, haciendo así, una tabla que tenga salida por management.</p>
<p>&nbsp;</p>
<p>Los datos que necesitamos son el del nombre de la interfaz de management que por defecto será <strong>mgmt </strong>y como llama internamente el sistema a la tarjeta de red, que por defecto será <strong>ens4 </strong>pero debemos de asegurarnos con el siguiente comando:</p>
<pre><code class="language-plaintext">nmcli c s

NAME  UUID                                  TYPE      DEVICE
svcs  33624002-7840-3820-80b4-51fac19609ca  ethernet  ens3
mgmt  88144039-5dab-3955-95da-163a4d0b32dc  ethernet  ens4</code></pre>
<p>&nbsp;</p>
<p>Posteriormente , con root, &nbsp;ejecutaremos los siguientes comandos en el orden que aparecen.</p>
<pre><code class="language-plaintext">nmcli con mod [IFACE_NAME] ipv4.route-table 10
nmcli con mod [IFACE_NAME] ipv4.routing-rules "priority 10 iif [IFACE_NAME] table 10"
nmcli con mod [IFACE_NAME] +ipv4.routing-rules "priority 10 from [IP_MGMT_ADDRESS] table 10"
nmcli con mod [IFACE_NAME] ipv4.routes "0.0.0.0/0 [NETWORK_MGMT_GATEWAY] table=10"
nmcli device reapply [DEVICE_NAME]</code></pre>
<p>&nbsp;</p>
<p>En caso de necesitar añadir más de una ruta añadir otra línea de ipv4.routes con el simbolo + delante, por ejemplo:</p>
<pre><code class="language-plaintext">nmcli con mod [IFACE_NAME] +ipv4.routes "0.0.0.0/0 [NETWORK_MGMT_GATEWAY] table=10"</code></pre>
<blockquote>
  <p><strong>NOTA</strong>: Cada interfaz sólo puede tener una tabla asignada</p>
</blockquote>
<p>&nbsp;</p>
<p>Si nos queremos cerciorar de que esta configurado correctamente, &nbsp;tenemos dos opciones, verlo en la tabla que hemos creado con el siguiente comando:</p>
<pre><code class="language-plaintext">ip route show table 10

default via [NETWORK_GATEWAY] dev [DEVICE_NAME] proto static metric 101
[NETWORK]/[MASK] dev [DEVICE_NAME] proto kernel scope link src [IP_MGMT_ADDRESS] metric 101</code></pre>
<p>&nbsp;</p>
<p>O en el path <strong>/etc/NetworkManager/system-connections</strong>, encontraremos un fichero con el nombre de la tarjeta tanto de servicios como de management , y en esta ultima veremos unas líneas debajo del tag de [ipv4] tal que asi:</p>
<pre><code class="language-plaintext">route-table=10
route1=0.0.0.0/0,[NETWORK_MGMT_GATEWAY]
route1_options=table=10
routing-rule1=priority 10 from 0.0.0.0/0 iif [IFACE_NAME] table 10
routing-rule2=priority 10 from [IP_MGMT_ADDRESS] table 10</code></pre>
<p>&nbsp;</p>
<p>Como apunte final, es recomendable, por no decir obligatorio, realizar un script con la configuración aplicada e ir actualizando el mismo conforme sea necesario la modificación de las reglas existentes para evitar la pérdida de las rutas.</p>
<p>&nbsp;</p>
