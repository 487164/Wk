<!--
title: SD-CYS-001 [ALTA] [ESPUBLICO] [MYSQL] Borrado de una base de datos
description: 
published: true
date: 2024-01-24T08:27:02.430Z
tags: 
editor: ckeditor
dateCreated: 2024-01-24T08:27:02.430Z
-->

<h1 style="text-align:center;">SD-CYS-001 [ALTA] [ESPUBLICO] [MYSQL] Borrado de una base de datos</h1>
<h2>Descripción</h2>
<p style="text-align:justify;">Este caso de uso identifica un borrado de una base de datos, en el que se lanza una <i>query </i>que contenga la sentencia ‘DROP DATABASE’.&nbsp;</p>
<ul>
  <li><strong>Nombre</strong>: Borrado de una base de datos</li>
  <li><strong>Criticidad</strong>: Alta</li>
  <li><strong>Tiempo de Atención</strong>: 30 minutos</li>
  <li><strong>Tecnologías utilizadas</strong>: MySQL Audit</li>
</ul>
<h2>MITRE</h2>
<ul>
  <li>TA0040 - Impact</li>
  <li>T1485 Data Destruction</li>
</ul>
<h2>What to do</h2>
<p style="text-align:justify;">Este caso de uso identifica el borrado de una base de datos mediante un ‘<i>DROP DATABASE’&nbsp;</i> en un servidor MYSQL. Habrá que comprobar el nombre de la base de datos que ha sido eliminada y a que servidor pertenece.</p>
<p style="text-align:justify;">Por lo general, en <i>pool-os-s03.gestiona.espublico.com</i> hacen importaciones y borrados, por lo que puede ser que este servidor haga saltar las alarmas.&nbsp;</p>
<p style="text-align:justify;">En caso de ser una actividad esperada, lo definiríamos como FP descartando un incidente de seguridad, y proporcionando la nota de cierre correspondiente con la investigación realizada.</p>
<h2>Notas de cierre</h2>
<p>Puntos mínimos que debe de tener un cierre:</p>
<ul>
  <li>Fecha/Hora</li>
  <li>Base de datos eliminada</li>
  <li>Servidor MySQL&nbsp;</li>
  <li>Username</li>
  <li>Resumen del análisis</li>
</ul>
<h2>Matriz de escalado</h2>
<p style="text-align:justify;">Aunque la matriz de escalado debería ser la misma para todos los casos de uso, puede haber casos que por falta de capacidades, por dependencias de otros servicio o incluso por que así se acuerde para un caso concreto, se debe definir la matriz de escalado.</p>
<p style="text-align:justify;">En horario laboral: Atiende N1 y escala a N2</p>
<p style="text-align:justify;">Fuera del horario Atiende N0 y escala a Guardia</p>
<h2>Reglas de caso de uso</h2>
<figure class="image image_resized" style="width:68.23%;"><img src="https://lh7-eu.googleusercontent.com/LMKIDI8WejSEZVKWmo0rXCHs_9fsiT03VLfncbga54Guog7zR66g56uef74qETvzzLYZdm3c7Xbi6kK9j7Z8P3E-QtV2mXquoyuiNDKiFnQOK6YOzrQ_ledy3tOzniXnPf3QmpdrJ2SZ6RZcF_CLZauRyJpsiUxKmLtRJIzftdfitF7eFSx2Dth_aj3i7u5z"></figure>
<h2>Campos Necesarios&nbsp;</h2>
<p>Los campos mínimos que deben seleccionarse para llevar a cabo la investigación:</p>
<ul>
  <li>Start Time</li>
  <li>Database Name (custom)</li>
  <li>Hostname (custom)</li>
  <li>Username</li>
  <li>Query (custom)</li>
  <li>Transaction _ID (custom)</li>
</ul>
<h2>Cierre por defecto</h2>
<p>Nota de cierre que se debería de rellenar a la hora de cerrar una alerta:</p>
<p><strong>Falso positivo:</strong></p>
<ul>
  <li>Se ha detectado un borrado de la db [<strong>Database Name(custom)</strong>], en el servidor [<strong>Hostname (Custom)</strong>] por el usuario [<strong>Username</strong>]. Se trata de una actividad esperada, por lo que se descarta como FP.&nbsp;</li>
</ul>
<p style="text-align:justify;"><strong>Falso positivo con ajuste:</strong></p>
<ul>
  <li>Se ha detectado un borrado de la db [<strong>Database Name(custom)</strong>], en el servidor [<strong>Hostname (Custom)</strong>] por el usuario [<strong>Username</strong>]. Si se localizara un&nbsp; fallo en la regla o posible mejora, se comentará [<strong>Descripción del ajuste necesario</strong>], y se abriría ticket en “<a href="https://soporte.iubaris.com/"><u>https://soporte.iubaris.com/</u></a>” (RT) con numero [<strong>Nº de ticket abierto</strong>].</li>
</ul>
<p><strong>Positivo contenido:</strong></p>
<ul>
  <li>Se ha detectado un borrado de la db [<strong>Database Name(custom)</strong>], en el servidor [<strong>Hostname (Custom)</strong>] por el usuario [<strong>Username</strong>]. Se trata de una actividad anómala e ilegítima, por lo que habrá que tomar las medidas pertinentes.</li>
</ul>
<p><strong>Positivo:</strong></p>
<ul>
  <li>Se ha detectado un borrado de la db [<strong>Database Name(custom)</strong>], en el servidor [<strong>Hostname (Custom)</strong>] por el usuario [<strong>Username</strong>]. Se trata de una actividad anómala e ilegítima, la cual ha generado consecuencias en el correcto funcionamiento de la organización.&nbsp;</li>
</ul>
