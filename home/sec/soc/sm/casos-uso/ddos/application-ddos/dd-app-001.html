<!--
title: DD-APP-001 [MEDIA] [WEB] Posible ataque DOS en un servidor web
description: 
published: true
date: 2024-01-24T08:47:39.395Z
tags: 
editor: ckeditor
dateCreated: 2024-01-24T08:47:39.395Z
-->

<h1 style="text-align:center;">DD-APP-001 [MEDIA] [WEB] Posible ataque DOS en un servidor web</h1>
<h2>Descripción</h2>
<p style="text-align:justify;">Este caso de uso identifica un posible ataque DOS a un servidor web, donde se detecta un gran volumen de tráfico que podría hacer que el servidor se congestionara y cayera.</p>
<ul>
  <li><strong>Nombre</strong>: Posible ataque DOS en un servidor web</li>
  <li><strong>Criticidad</strong>: Media</li>
  <li><strong>Tiempo de Atención</strong>: 90 minutos</li>
  <li><strong>Tecnologías utilizadas</strong>: Apache, Nginx, Amazon AWS y Microsoft IIS</li>
</ul>
<h2>MITRE</h2>
<ul>
  <li>TA0040 – Impact</li>
  <li>T1499 Endpoint Denial of Service</li>
</ul>
<h2>What to do</h2>
<p style="text-align:justify;">Este Caso de Uso identifica un posible ataque DOS desde una dirección IP externa&nbsp; a un servidor web de la organización. Alertará cuando se reciban al menos 10 eventos con peticiones mal formadas, generando Codigos de Error ‘503’ (<i>servidor no listo para manejar la solicitud&nbsp; por inoperatividad o sobrecarga</i>) en 10 minutos, después de haberse generado 10 eventos con la misma dirección IP de origen.</p>
<p style="text-align:justify;">Deberá localizarse la dirección IP de origen que está provocando el tráfico y ver de donde proviene, al igual que el servidor web que se está viendo afectado. También puede observarse el campo ‘<i>Bytes Sent (custom)</i>’ para ver el volumen de datos enviados.</p>
<p style="text-align:justify;">En caso de ser una actividad esperada o una mala detección por parte de QRadar, lo definiríamos como FP descartando un incidente de seguridad, y proporcionando la nota de cierre correspondiente con la investigación realizada.</p>
<h2>Notas de cierre</h2>
<p>Puntos mínimos que debe de tener un cierre:</p>
<ul>
  <li>Servidor Web afectado</li>
  <li>Dirección IP responsable del tráfico anómalo</li>
  <li>Nº eventos</li>
  <li>Resumen del análisis</li>
</ul>
<h2>Matriz de escalado</h2>
<p>Aunque la matriz de escalado debería ser la misma para todos los casos de uso, puede haber casos que por falta de capacidades, por dependencias de otros servicio o incluso por que así se acuerde para un caso concreto, se debe definir la matriz de escalado.</p>
<p>En horario laboral: Atiende N1 y escala a N2</p>
<p>Fuera del horario Atiende N0 y escala a Guardia</p>
<h2>Reglas de caso de uso</h2>
<p>Información de la regla:</p>
<figure class="image image_resized" style="width:80.8%;"><img src="https://lh7-eu.googleusercontent.com/PhOmCGmNpzohj5Vxi3r9WfF5CC7tC0Y6hr2RlMRUFvBvtzbY2BvAUVbmUOp2vNkvQLqIHTMV8iW6splybw8TCA5L8RlvkWcP2armc1reierOeJDLo2naavPxlCy-q7D_Bw99mhEvG14o"></figure>
<h2>Campos Necesarios</h2>
<p>Los campos mínimos que deben seleccionarse para llevar a cabo la investigación:</p>
<ul>
  <li>Start Time</li>
  <li>Event Name</li>
  <li>URL Referrer (custom)</li>
  <li>URL Path</li>
  <li>Source IP</li>
  <li>Destination IP</li>
  <li>Destination Port</li>
  <li>Event Count</li>
</ul>
<h2>Cierre por defecto</h2>
<p>Nota de cierre que se debería de rellenar a la hora de cerrar una alerta:</p>
<p><strong>Falso positivo:</strong></p>
<ul>
  <li>Se ha detectado un posible ataque DOS en un servidor web, se analizan los eventos “HTTP 503 - Service Unavailable” por lo que se revisa el&nbsp; [<strong>URL Path (custom)</strong>] en RT (solo el “pool” que corresponda) para comprobar si el servicio se ha detenido y si lo está, si ha sido de forma controlada, provocando el corte de servicio y haciendo que salte la alerta.</li>
</ul>
<p><strong>Falso positivo con ajuste:</strong></p>
<ul>
  <li>Se ha detectado un posible ataque DOS en un servidor web, se analizan los eventos “HTTP 503 - Service Unavailable” por lo que se revisa el&nbsp; [<strong>URL Path (custom)</strong>] en RT (solo el “pool” que corresponda) para comprobar si el servicio se ha detenido y si lo está, si ha sido de forma controlada, provocando el corte de servicio y haciendo que salte la alerta, sin embargo se localiza un&nbsp; fallo en la regla en la que [<strong>Descripción del ajuste necesario</strong>], por lo cual se abre ticket en “<a href="https://soporte.iubaris.com/"><u>https://soporte.iubaris.com/</u></a>” (RT) con numero [<strong>Nº de ticket abierto</strong>].</li>
</ul>
<p><strong>Positivo contenido:</strong></p>
<ul>
  <li>Se ha detectado un ataque DOS en un servidor web, se recogen un ingente numero de eventos indicando error “HTTP 503 - Service Unavailable” por lo que se revisa el&nbsp; [<strong>URL Path (custom)</strong>] en RT (solo el “pool” que corresponda) para comprobar si el servicio se ha detenido de forma controlada, al no encontrar ningún ticket de trabajo de dicha máquina, se revisa esta en Zabbix si la máquina está funcionando. (<strong>REVISAR EVENTOS QRADAR CUANDO SE BLOQUEA IP POR ATAQUE DOS</strong>)</li>
</ul>
<p><strong>Positivo:</strong></p>
<ul>
  <li>Se ha detectado un ataque DOS en un servidor web, se analizan los eventos “HTTP 503 - Service Unavailable” por lo que se revisa el&nbsp; [<strong>URL Path (custom)</strong>] en RT (solo el “pool” que corresponda) para comprobar si el servicio se ha detenido de forma controlada, al no encontrar ningún ticket de trabajo de dicha máquina, se revisa esta en Zabbix si la máquina está funcionando, comprobando que esta caída.</li>
</ul>
