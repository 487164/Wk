<!--
title: EX-BRU-006  [MEDIA] [MULTI] Múltiples fallos de acceso en servidores no windows con un mismo usuario
description: 
published: true
date: 2024-01-24T11:33:23.001Z
tags: 
editor: ckeditor
dateCreated: 2024-01-24T11:33:23.001Z
-->

<h1 style="text-align:center;">EX-BRU-006&nbsp; [MEDIA] [MULTI] Múltiples fallos de acceso en servidores no windows con un mismo usuario</h1>
<h2>Descripción</h2>
<p style="text-align:justify;">Este caso de uso identifica múltiples fallos de autenticación en servidores no-windows. De esta forma, se busca detectar todos aquellos intentos de acceso posiblemente ilegítimos a sistemas Linux desde una misma dirección IP en un corto periodo de tiempo.</p>
<ul>
  <li><strong>Nombre</strong>: Múltiples fallos de autenticación en servidores no-windows.</li>
  <li><strong>Criticidad</strong>: Media</li>
  <li><strong>Tiempo de Atención</strong>: 90 minutos</li>
  <li><strong>Tecnologías utilizadas</strong>: Logs locales</li>
</ul>
<h2>MITRE</h2>
<ul>
  <li>TA0006 - Credential Access.</li>
  <li>TA0007 - Discovery.</li>
  <li>TA0008 - Latereal Movement</li>
  <li>T1021 - Remote Services<ul>
      <li>T1021.004 - SSH</li>
    </ul>
  </li>
</ul>
<h2>What to do</h2>
<p style="text-align:justify;">Se debe revisar el usuario que ha fallado la autenticación, en qué sistema ha sido, y se deberá poner en contacto con él para verificar si ha sido consciente de estos errores, confirmando así que ha sido un error humano o posible fallo de configuración.&nbsp;</p>
<p style="text-align:justify;">En caso de que el usuario no sea consciente de estos intentos de acceso, se monitorizará una franja de tiempo anterior y posterior a los errores de autenticación. De esta forma se tendrá una visión de los movimientos anteriores a los fallos y posteriores, por si ha intentado hacer cualquier otro intento de acceso.&nbsp;</p>
<p style="text-align:justify;">Monitorizando el servidor afectado, se puede detectar si ha acabado habiendo un acceso satisfactorio por el usuario que ha estado dando error, o por otro distinto en caso de que se haya intentado acceder con diferentes usuarios, detectando así posibles casos de “Password Spraying”. Se escalará al personal competente para actuar en el sistema correspondiente.&nbsp;</p>
<p style="text-align:justify;">En caso de tratarse de alguien que ha fallado de forma consciente, lo definiríamos como Falso_Positivo, descartando un incidente de seguridad y proporcionando la nota de cierre correspondiente con la investigación realizada.</p>
<h2>Notas de cierre</h2>
<p>Puntos mínimos que debe de tener un cierre</p>
<ul>
  <li>Usuario infractor</li>
  <li>Servidor en el que se han producido los errores</li>
  <li>Fecha/Hora de los intentos fallidos de login</li>
  <li>Número de intentos de login</li>
  <li>Resumen del análisis</li>
</ul>
<h2>Matriz de escalado</h2>
<p style="text-align:justify;">En esta alerta, el escalado se realizaría si después de terminar la investigación ya sea por falta de conocimientos o por sucesos sospechosos que se hayan visto no se pueda descartar un posible incidente de seguridad. Dependiendo del horario en que nos encontremos el escalado será distinto:</p>
<p style="text-align:justify;">En horario laboral: Atiende en primera instancia N1 y si es necesario escalar, pasaría a N2.</p>
<p style="text-align:justify;">Fuera del horario Atiende el técnico de 24/7 que se encuentre y en caso necesario escalaría a Guardia ya que al ser una alerta ALTA se podría dar un incidente de seguridad.</p>
<h2>Reglas de caso de uso</h2>
<p style="text-align:justify;">A continuación se muestran las reglas que tienen que darse para que salte la alerta:</p>
<figure class="image image_resized" style="width:72.19%;"><img src="https://lh7-eu.googleusercontent.com/fKJqAnAhILNNNJAP89oLaIZ62wdCpUCY023KSraH-6rREbExmPriYesv8-8Pd20aOOZIwlqTGehaDYzQE2fZ4RE74dKoUh1cqpgkpnB749EO9tP51SMNqxs6-uKGgEjflHO8SEeuKzfOecCcJ26Au0A"></figure>
<h2>Campos Necesarios</h2>
<p>Los campos mínimos que deben seleccionarse para llevar a cabo la investigación:</p>
<ul>
  <li>Start Time</li>
  <li>Event Name</li>
  <li>Username</li>
  <li>Command (custom)</li>
  <li>Source IP</li>
  <li>Machine Identifier (custom)</li>
</ul>
