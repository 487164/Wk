<!--
title: AO-DBC-002 [ALTA] [ESPUBLICO] [MYSQL] Login satisfactorio después de varios fallos de autenticación en servidor MySQL
description: 
published: true
date: 2024-01-24T09:45:18.882Z
tags: 
editor: ckeditor
dateCreated: 2024-01-22T12:21:42.961Z
-->

<h1 style="text-align:center;">AO-DBC-002 [ALTA] [ESPUBLICO] [MYSQL] Login satisfactorio después de varios fallos de autenticación en servidor MySQL</h1>
<h2>Descripción</h2>
<p style="text-align:justify;">Este caso de uso identifica fallos de Login con un usuario en un servidor MySQL, con un posterior Login correcto, identificando así un posible acceso comprometido.&nbsp;</p>
<ul>
  <li><strong>Nombre</strong>: Login satisfactorio después de varios fallos de autenticación en servidor MySQL</li>
  <li><strong>Criticidad</strong>: Alta</li>
  <li><strong>Tiempo de Atención</strong>: 30 minutos</li>
  <li><strong>Tecnologías utilizadas</strong>: MySQL Audit</li>
</ul>
<h2>MITRE</h2>
<ul>
  <li>TA0006 - Credential Access</li>
  <li>T1110 - Brute Force</li>
</ul>
<h2>What to do</h2>
<p style="text-align:justify;">Un Login correcto posterior a que se produzcan hasta 5 fallos de autenticación en un servidor MySQL, en un intervalo de 10 minutos, puede estar identificando un acceso por fuerza bruta o adivinación.</p>
<p style="text-align:justify;">Para el seguimiento de los fallos de autenticación en MySQL se puede revisar el <i>QID: 1004500012 (MySQL Login Failed)</i>&nbsp;</p>
<p style="text-align:justify;">Deberá revisarse en que servidores MySQL se han intentado autenticar provocando fallos, que usuarios han sido y la dirección IP desde la que lo ha intentado. Habrá que poner foco en el servidor en el que han logrado autenticarse y comunicarse con el usuario para determinar si es consciente de dichas autenticaciones. También deben revisarse las acciones posteriores al acceso.</p>
<p style="text-align:justify;">En caso de ser una actividad esperada por el usuario, lo definiríamos como FP descartando un incidente de seguridad, y proporcionando la nota de cierre correspondiente con la investigación realizada.</p>
<h2>Notas de cierre</h2>
<p>Puntos mínimos que debe de tener un cierre:</p>
<ul>
  <li>Usuario que ha generado los fallos de autenticación y ha logrado acceder</li>
  <li>Servidor MySQL objetivo</li>
  <li>Fecha/Hora</li>
  <li>Seguimiento posterior de la actividad del usuario</li>
  <li>Resumen del análisis</li>
</ul>
<h2>Matriz de escalado</h2>
<p style="text-align:justify;">Aunque la matriz de escalado debería ser la misma para todos los casos de uso, puede haber casos que por falta de capacidades, por dependencias de otros servicio o incluso por que así se acuerde para un caso concreto, se debe definir la matriz de escalado.</p>
<p style="text-align:justify;">En horario laboral: Atiende N1 y escala a N2</p>
<p style="text-align:justify;">Fuera del horario Atiende N0 y escala a Guardia</p>
<h2>Reglas de caso de uso</h2>
<figure class="image image_resized" style="width:62.3%;"><img src="https://lh7-eu.googleusercontent.com/QAk79hS_dksgKMIdyEEDcyIYxVejLvL-bwlJr2NV-Z8OfDfOgJ01N4qbSuUmSNsqbhyGBaVS_nbCAHf1FS4o-1hsA3YEtml9-fbk106H3bEteLH6uRgpPkaftujfi_8QH5d_FuRPhDw"></figure>
<h2>Campos Necesarios&nbsp;</h2>
<p>Los campos mínimos que deben seleccionarse para llevar a cabo la investigación:</p>
<ul>
  <li>Start Time</li>
  <li>Username</li>
  <li>Hostname (custom)</li>
  <li>Source IP</li>
  <li>Event Count</li>
</ul>
<h2>Cierre por defecto</h2>
<p>Nota de cierre que se debería de rellenar a la hora de cerrar una alerta:</p>
<p><strong>Falso positivo:</strong></p>
<ul>
  <li>Se ha detectado un Login correcto en servidor MySQL por parte del usuario [<strong>Username</strong>], a la máquina [<strong>Hostname (Custom)</strong>]. Anteriormente se han observado fallos de autenticación por parte del usuario [<strong>Username</strong>]&nbsp; en la misma o varias máquinas [<strong>Hostname (Custom)</strong>]. [<strong>Análisis de la actividad del Usuario y la actividad realizada</strong>].</li>
</ul>
<p><strong>Falso positivo con ajuste:</strong></p>
<ul>
  <li>Se ha detectado un Login correcto en servidor MySQL por parte del usuario [<strong>Username</strong>], a la máquina [<strong>Hostname (Custom)</strong>]. Anteriormente se han observado fallos de autenticación por parte del usuario [<strong>Username</strong>]&nbsp; en la misma o varias máquinas [<strong>Hostname (Custom)</strong>]. [<strong>Análisis de la actividad del Usuario y la actividad realizada</strong>]. Si se localizara un&nbsp; fallo en la regla, se comentará [<strong>Descripción del ajuste necesario</strong>], y se abriría ticket en “<a href="https://soporte.iubaris.com/"><u>https://soporte.iubaris.com/</u></a>” (RT) con numero [<strong>Nº de ticket abierto</strong>].</li>
</ul>
<p><strong>Positivo contenido:</strong></p>
<ul>
  <li>Se ha detectado un Login correcto en servidor MySQL por parte del usuario [<strong>Username</strong>], a la máquina [<strong>Hostname (Custom)</strong>]. Anteriormente se han observado fallos de autenticación por parte del usuario [<strong>Username</strong>]&nbsp; en la misma o varias máquinas [<strong>Hostname (Custom)</strong>]. [<strong>Análisis de la actividad del Usuario y la actividad realizada</strong>]. Se ha tratado de una acción ilegítima y se han tomado las medidas pertinentes.</li>
</ul>
<p><strong>Positivo:</strong></p>
<ul>
  <li>Se ha detectado un Login correcto en servidor MySQL por parte del usuario [<strong>Username</strong>], a la máquina [<strong>Hostname (Custom)</strong>]. Anteriormente se han observado fallos de autenticación por parte del usuario [<strong>Username</strong>]&nbsp; en la misma o varias máquinas [<strong>Hostname (Custom)</strong>]. [<strong>Análisis de la actividad del Usuario y la actividad realizada</strong>]. Se ha tratado de una acción ilegítima que ha causado diversas consecuencias.</li>
</ul>
