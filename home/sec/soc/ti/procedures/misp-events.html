<!--
title: MISP Events
description: Procedimiento para crear eventos en la MISP
published: true
date: 2024-03-06T10:45:13.445Z
tags: soc, ti, misp, procedure
editor: ckeditor
dateCreated: 2024-03-06T08:58:12.013Z
-->

<h1 style="text-align:center;">MISP Events</h1>
<p>MISP es una solución de software de código abierto para recopilar, almacenar, distribuir y compartir IOC (<i>Indicator of Compromise</i>) de incidentes de ciberseguridad y análisis de malware.</p>
<p>El objetivo de MISP es fomentar el intercambio de información estructurada dentro de la comunidad de ciberseguridad.</p>
<p>Actualmente participamos en el proyecto de la RNS, donde utilizamos nuestra MISP para compartir IOCs con la MISP oficial de la RNS.</p>
<p>&nbsp;</p>
<h2>RNS</h2>
<p>El CCN-CERT (<i>Centro Criptológico Nacional Computer Emergency Response Team</i>) crea la RNS (<i>Red Nacional de SOC</i>), plataforma que integra los SOC de todos los organismos públicos de la Administración Española, junto con las entidades proveedoras que prestan dichos servicios de SOC y las entidades públicas que se benefician de los mismos.</p>
<p>Su objetivo principal es impulsar la capacidad de Protección de sus miembros mediante el bloqueo casi inmediato de cualquier indicio de actividad anómala que se esté detectando en cualquier punto de la Administración.</p>
<p>Las entidades proveedoras pueden tener dos niveles:</p>
<ul>
  <li><strong>GOLD</strong>: Proveedores con un nivel alto de participación. Tendrán acceso inmediato a toda la información compartida y consolidada en la RNS.</li>
  <li><strong>Informado</strong>: Proveedores con un nivel de participación normal. Tendrán acceso a la información compartida y consolidada en la RNS, pero con cierto retraso</li>
</ul>
<p>Actualmente esPublico cuenta con el nivel GOLD dada la alta participación que hay en el intercambio de IOC mediante la MISP.</p>
<p>&nbsp;</p>
<h3>Puntuación</h3>
<p>La RNS cuenta con una tabla de puntuación, con la cual evalúan los distintos eventos que suben las organizaciones que participan en el proyecto.</p>
<p>Existe un TOP 10 donde se posicionan aquellas organizaciones que mas puntuación van consiguiendo.</p>
<p>La puntuación depende de los atributos que están incluidos en los eventos que se suben a la MISP y se comparten con la RNS, siendo valorados de la siguiente manera:</p>
<ul>
  <li><strong>1 punto</strong>: IP o dirección de correo</li>
  <li><strong>2 puntos</strong>: Hash, dominio o URL</li>
  <li><strong>3 puntos</strong>: Reglas YARA o SNORT</li>
</ul>
<p>La puntuación se asigna por evento, por lo que da igual la cantidad de atributos que se incluyan. Es decir, un evento estará valorado en 1 punto ya sea que tenga 1 IP o 50 IP.</p>
<p>Hay que tener en cuenta que para conseguir la puntuación mencionada, el atributo no deberá haber sido ya compartido en la RNS, que no este en REYES ni en ninguna Whitelist.</p>
<p>&nbsp;</p>
<h2>Crear Evento</h2>
<p>Se accede a la MISP de esPublico a través de <a href="https://misp.security.espublico.com">https://misp.security.espublico.com</a> y para crear un evento, en la parte izquierda, se selecciona “<i>Add Event</i>”.</p>
<p>Los campos a tener en cuenta que deben modificarse son:</p>
<ul>
  <li><strong>Distribution</strong>: ponerlo como “<i>All communities</i>” para poder distribuirlo con todos los miembros.</li>
  <li><strong>Threat Level</strong>: dependerá del nivel de amenaza que se haya analizado y se vaya a reflejar en el evento.</li>
  <li><strong>Analysis</strong>: Por lo general se creará como “<i>Completed</i>”, ya que ya ha habido un análisis previo a la hora de compartir los IOC.</li>
  <li><strong>Event Info</strong>: Nombre descriptivo del incidente que se reporta.</li>
</ul>
<p>&nbsp;</p>
<h3>TAGS</h3>
<p>Los tags que deben llevar los eventos compartidos con la RNS son los siguientes:</p>
<ul>
  <li><strong>tlp</strong>: Siempre “tlp:green”, salvo que por experiencia se quiera configurar algo diferente (la RNS sólo admitirá los valores “clear”, “green” y “amber, y el antiguo “white”).</li>
  <li><strong>PAP</strong>: Siempre “PAP:GREEN”, salvo que por experiencia se quiera configurar algo diferente (la RNS sólo admitirá los valores “WHITE” y “GREEN”).</li>
  <li><strong>circl</strong>: Al menos una etiqueta de tipo “incident-classification”.</li>
  <li><strong>ecsirt</strong>: Esta clasificación está relativamente relacionada con la clasificación de incidentes establecida en la guía <a href="https://www.ccn-cert.cni.es/es/series-ccn-stic/800-guia-esquema-nacional-de-seguridad/988-ccn-stic-817-gestion-de-ciberincidentes/file?format=html">CCN-STIC 817 “ENS. Gestión de ciberincidentes”</a></li>
  <li><strong>red-nacional-soc:status="ongoing"</strong>: Es el tag que permite que el evento se propague a la RNS, si este tag no se incluye nunca se compartirá con la RNS.</li>
</ul>
<p>&nbsp;</p>
<h3>Galaxy</h3>
<p>En el apartado “<i>Galaxies</i>” podremos añadir contexto a los eventos, pudiendo catalogar el evento mediante la matriz de MITRE ATT&amp;CK.</p>
<p>Seleccionando “<i>Add new cluster → &amp; Attack Patern</i>”, se desplegara la matriz entera de MITRE ATT&amp;CK para poder seleccionar las tácticas y técnicas que sean apropiadas para el evento.</p>
<p>&nbsp;</p>
<h3>Atributos</h3>
<p>Para añadir atributos se seleccionará “<i>Add Attribute</i>”, donde los campos a rellenar serán los siguientes:</p>
<ul>
  <li><strong>Category</strong>: La categoría del IOC (<i>Network Activity, Artifacts dropped, etc</i>)</li>
  <li><strong>Type</strong>: Dependiendo de la categoría se tendrán unos tipos u otros (<i>IP, hashes, dominios, SNORT, YARA, etc</i>)</li>
  <li><strong>Distribution</strong>: Siempre ira en “<i>Inherit Event</i>”</li>
  <li><strong>Value</strong>: Aquí se especifica el IOC a compartir</li>
  <li><strong>First seen date/Last seen date:</strong> Se pueden dejar vacíos, a no ser que se quiera especificar la primera vez y ultima vez que fui vista la actividad</li>
</ul>
<p>Una vez añadidos los atributos, es importante marcar la opción de “<i><strong>IDS</strong></i>” a aquellos atributos que sean considerados un peligro y deban bloquearse.</p>
<p>Aquellos atributos que se suban tan solo para dar contexto al evento, y por lo tanto no sean considerados como atributos a bloquear, no deberán marcarse con el check de “<i><strong>IDS</strong></i>”.</p>
<p>&nbsp;</p>
<p>Y por último, destacar que no debe compartirse información que pueda contener datos personales, ni pueden subirse mas de <i><u>150 atributos</u></i> por evento.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
