<!--
title: Intelligence X
description: 
published: true
date: 2024-02-16T08:40:42.366Z
tags: soc, ti, procedure, report
editor: ckeditor
dateCreated: 2024-02-14T11:31:43.707Z
-->

<h1 style="text-align:center;">IntelX</h1>
<p style="text-align:justify;">Para la detección de exposición de credenciales, tanto de miembros de la organización, como de clientes, actualmente&nbsp;se utiliza la herramienta <a href="https://intelx.io/">IntelX</a>.</p>
<p style="text-align:justify;">Intelx o IntelligenceX es una herramienta de búsqueda en línea que se utiliza para realizar OSINT (<i>Open Source Intelligence</i>).</p>
<p style="text-align:justify;">Cuenta con las siguientes características:</p>
<ul>
  <li style="text-align:justify;">Las búsquedas se realizan a través de selectores. Un selector es un término de búsqueda específico, como una dirección de correo electrónico, un dominio, una URL, una dirección IP, una dirección de Bitcoin, un hash, etc.</li>
  <li style="text-align:justify;">Puede llevar a cabo búsquedas tanto en la DarkNet como en fuentes públicas, así como en plataformas de compartición de documentos, Corea del Norte, etc.</li>
  <li style="text-align:justify;">Mantiene un archivo histórico de resultados, similar a como Wayback Machine, de archive.org, almacena copias históricas de sitios web, lo que permite retroceder en el tiempo y buscar datos históricos y documentos.</li>
</ul>
<p>&nbsp;</p>
<h2>Scripts</h2>
<p style="text-align:justify;">Se lleva a cabo en la maquina ‘itx-sec-ds-01-svcs.madrid.espublico.com’ la ejecución de scripts automatizados mediante cron.</p>
<p style="text-align:justify;">Estos scripts se encargan de consultar a la API de IntelX si ha habido una posible filtración de los dominios especificados en una lista de dominios de <a href="https://dashboard.security.espublico.com/d/e660e1c1-47bf-4cd5-ad9f-51ce2bc24a17/dominios?orgId=2">Digital Surveillance</a> y que se pueden consultar a través de la url</p>
<pre><code class="language-plaintext">https://intel.security.espublico.com/lists/espublico-domain-data_leaks.txt</code></pre>
<p style="text-align:justify;">&nbsp;</p>
<p style="text-align:center;">&nbsp;</p>
<h3>run-check</h3>
<p style="text-align:justify;">Esta script se encarga de hacer un checkeo cada 24 horas contra la API de IntelX para comprobar si se ha detectado la filtración de credenciales de alguno de los dominios expuestos en la lista.&nbsp;</p>
<p>La script se ejecuta a las 07:00 de la mañana todos los días.</p>
<p>&nbsp;</p>
<h3>run-process</h3>
<p>Esta script se encarga de guardar los ficheros en bruto detectados en el directorio siguiente organizados por fecha en formato YYYYMMDD</p>
<pre><code class="language-plaintext">/data/Threat-intelligence/intelxio/tmp/YYYYMMDD</code></pre>
<p>Para hacer un filtrado de la información que nos interesa y facilitar el análisis, también guarda los datos específicos relacionados con los dominios expuestos en la lista, en el directorio</p>
<pre><code class="language-plaintext">/data/Digital-surveillance/espublico/reports/YYYYMMDD/intelx/</code></pre>
<p>de la maquina de DS.</p>
<p>La script se ejecuta a continuación del anterior.</p>
<p>&nbsp;</p>
<h3>intelxio-clean</h3>
<p>Esta script se encarga de borrar los ficheros almacenados con una antigüedad de 7 días.</p>
<p>&nbsp;</p>
<h2>Alerta</h2>
<p>En QRadar existe la regla ‘<i>FE-EXF-006 [ALTA] [ESPUBLICO] [SOAR] [INTELX] Posible exposicion de credenciales Intelx</i>’, la cual detecta si la script ha detectado una filtración de credenciales.</p>
<p>El evento que genera es ‘<i>Search leaks</i>’ (QID 1008250026), en el cual nos pueden interesar los campos de ‘<i>Filename</i>’, ‘<i>search</i>’ y ‘<i>searchid</i>’ de la detección.</p>
<p>El contenido del campo ‘<i>searchid</i>’ podemos anidarlo a ‘<i>intelx.io/?did=</i>’ para ir a la filtración detectada y poder examinarla con mas detalle si se requiere.</p>
<p>&nbsp;</p>
<h2>Análisis del contenido</h2>
<p>Si se quiere ir directamente a los datos, podemos acceder al directorio&nbsp;</p>
<pre><code class="language-plaintext">/data/Digital-surveillance/espublico/reports/YYYYMMDD/intelx/</code></pre>
<p><i>de la maquina de DS </i>donde se han guardado los datos ya filtrados, o acceder por web a<i> ‘https://intel.security.espublico.com/reports/YYYYMMDD/intelx/</i>’.</p>
<p style="text-align:center;">&nbsp;</p>
<h2>Usuarios ya reportados</h2>
<p>Al analizar las filtraciones, deben revisarse si ya han sido reportadas en alguna ocasión, para ello hay un listado anotado de anteriores filtraciones en <a href="https://docs.google.com/spreadsheets/d/1NkLmStHp7YMMx1GC103HKPu522-TZ6YV/edit#gid=1866393291">Usuarios_<i>reportados</i>_Intelx</a>.</p>
<p>En caso de no haber sido reportado anteriormente, deberá anotarse el usuario, fecha y plataforma de filtración.</p>
<p>&nbsp;</p>
<h2>Reporte</h2>
<p>Una vez se han analizadas las filtraciones y anotadas en la hoja, deberá reportarse a Cumplimiento Normativo.&nbsp;</p>
<p>Por lo que se mandará un correo a ‘cumplimientonormativo@espublico.com’, en copia el director de seguridad y los miembros del equipo de Inteligencia.&nbsp;</p>
<p>El contenido del correo deberá contener siempre el ‘pool’ y el ‘usuario’ de la filtración, <strong>NUNCA </strong>se especificará la contraseña que ha sido filtrada.</p>
<p>Desde cumplimiento normativo se encargaran de gestionar la filtración.&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
